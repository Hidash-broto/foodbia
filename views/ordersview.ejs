<div class="container-fluid pt-4 px-4">
  <div class="row">
    <div class="col-xl-2"></div>
    <div class="col-sm-12 col-xl-6 ml-5">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">No</th>
            <th scope="col">Date</th>
            <th scope="col">Address</th>
            <th scope="col">Total Price</th>
            <th scope="col">Payment</th>
            <th scope="col">Status</th>
            <th scope="col">Option</th>
          </tr>
        </thead>
        <% orders.forEach((order, index)=>{ %>
          <tbody>
            <tr>
              <th><%= index+1 %> </th>
              <td>
                <%=order.date%>
              </td>
              <td>
                <%=order.address%>
              </td>
              <td>
                <%=order.totalPrice%>
              </td>
              <td>
                <%=order.paymentMethod%>
              </td>
              <td>
                <%=order.Status%>
              </td>
              <% if(order.Status=='Cancelled' || order.Status=='Delivered' ){ %>
                <td id="siddeeque">
                  <%= order.Status %>
                </td>
                <% }else{ %>
                  <td>
                    <select name="" onchange="status(this, '<%=order._id%>')">
                      <option value="<%= order.Status%>" selected>
                        <%= order.Status%>
                      </option>
                      <option>Pending</option>
                      <option>Delivered</option>
                      <option>Cancelled</option>
                      <option>Confirmed</option>
                      <option>Shipped</option>
                    </select>
                  </td>
                  <% } %>
            </tr>
          </tbody>
          <% }) %>
      </table>
    </div>
  </div>
</div>

<head>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<script>
  function status(e, od) {
    $.ajax({
      url: `/changeStatus?s=${e.value}&id=${od}`,
      method: "get",
      success: (res) => {
        if (res.Status) {
          console.log('Hello');
          Swal.fire({
            position: "top-end",
            icon: "success",
            title: "Your work has been saved",
            showConfirmButton: false,
            timer: 1500,
          });
        } else {
          location.reload()
        }
      },
    });
  }
</script>